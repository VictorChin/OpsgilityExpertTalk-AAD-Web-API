/*! @azure/msal-browser v2.0.0-beta.0 2020-04-15 */
"use strict";!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).msal={})}(this,function(e){var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function t(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var c=function(){return(c=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function s(i,c,s,a){return new(s=s||Promise)(function(e,t){function r(e){try{n(a.next(e))}catch(e){t(e)}}function o(e){try{n(a.throw(e))}catch(e){t(e)}}function n(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(r,o)}n((a=a.apply(i,c||[])).next())})}function a(r,o){var n,i,c,e,s={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(c=2&t[0]?i.return:t[0]?i.throw||((c=i.return)&&c.call(i),0):i.next)&&!(c=c.call(i,t[1])).done)return c;switch(i=0,c&&(t=[2&t[0],c.value]),t[0]){case 0:case 1:c=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(c=0<(c=s.trys).length&&c[c.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!c||t[1]>c[0]&&t[1]<c[3])){s.label=t[1];break}if(6===t[0]&&s.label<c[1]){s.label=c[1],c=t;break}if(c&&s.label<c[2]){s.label=c[2],s.ops.push(t);break}c[2]&&s.ops.pop(),s.trys.pop();continue}t=o.call(r,s)}catch(e){t=[6,e],i=0}finally{n=c=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function r(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var g=function(){return(g=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function p(i,c,s,a){return new(s=s||Promise)(function(e,t){function r(e){try{n(a.next(e))}catch(e){t(e)}}function o(e){try{n(a.throw(e))}catch(e){t(e)}}function n(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(r,o)}n((a=a.apply(i,c||[])).next())})}function f(r,o){var n,i,c,e,s={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(c=2&t[0]?i.return:t[0]?i.throw||((c=i.return)&&c.call(i),0):i.next)&&!(c=c.call(i,t[1])).done)return c;switch(i=0,c&&(t=[2&t[0],c.value]),t[0]){case 0:case 1:c=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(c=0<(c=s.trys).length&&c[c.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!c||t[1]>c[0]&&t[1]<c[3])){s.label=t[1];break}if(6===t[0]&&s.label<c[1]){s.label=c[1],c=t;break}if(c&&s.label<c[2]){s.label=c[2],s.ops.push(t);break}c[2]&&s.ops.pop(),s.trys.pop();continue}t=o.call(r,s)}catch(e){t=[6,e],i=0}finally{n=c=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function i(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var i=arguments[t],c=0,s=i.length;c<s;c++,n++)o[n]=i[c];return o}var u,h={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."}},d=(r(l,u=Error),l.createUnexpectedError=function(e){return new l(h.unexpectedError.code,h.unexpectedError.desc+": "+e)},l);function l(e,t){var r=u.call(this,t)||this;return Object.setPrototypeOf(r,l.prototype),r.errorCode=e,r.errorMessage=t,r.name="AuthError",r}var y,m="1.0.0-beta.0",w={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},E={code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},v={code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},I={code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},S={code:"token_request_cache_error",desc:"The token request could not be fetched from the cache correctly."},C={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},b={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please review the trace to determine the root cause."},T={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},R={code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},_={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},O={code:"account_mismatch",desc:"The cached account and account which made the token request do not match."},k={code:"invalid_id_token",desc:"Invalid ID token format."},A={code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},N={code:"cache_parse_error",desc:"Could not parse cache key."},P={code:"user_login_error",desc:"User login is required."},U={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority, resource, or account."},q={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},x={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},D={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},L={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},M={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},H=(r(j,y=d),j.createClientInfoDecodingError=function(e){return new j(w.code,w.desc+" Failed with error: "+e)},j.createClientInfoEmptyError=function(e){return new j(E.code,E.desc+" Given Object: "+e)},j.createIdTokenParsingError=function(e){return new j(v.code,v.desc+" Failed with error: "+e)},j.createIdTokenNullOrEmptyError=function(e){return new j(I.code,I.desc+" Raw ID Token Value: "+e)},j.createTokenRequestCacheError=function(e){return new j(S.code,S.desc+" Error Detail: "+e)},j.createEndpointDiscoveryIncompleteError=function(e){return new j(C.code,C.desc+" Detail: "+e)},j.createInvalidAuthorityTypeError=function(e){return new j(b.code,b.desc+" Given Url: "+e)},j.createHashNotDeserializedError=function(e){return new j(T.code,T.desc+" Given Object: "+e)},j.createStateMismatchError=function(){return new j(R.code,R.desc)},j.createNonceMismatchError=function(){return new j(_.code,_.desc)},j.createAccountMismatchError=function(){return new j(O.code,O.desc)},j.createInvalidIdTokenError=function(e){return new j(k.code,k.desc+" Given token: "+JSON.stringify(e))},j.createNoTokensFoundError=function(e){return new j(A.code,A.desc+" Scopes: "+e)},j.createCacheParseError=function(e){return new j(N.code,N.desc+" Cache key: "+e)},j.createUserLoginRequiredError=function(){return new j(P.code,P.desc)},j.createMultipleMatchingTokensInCacheError=function(e){return new j(U.code,"Cache error for scope "+e+": "+U.desc+".")},j.createTokenRequestCannotBeMadeError=function(){return new j(q.code,q.desc)},j.createAppendEmptyScopeToSetError=function(e){return new j(x.code,x.desc+" Given Scope: "+e)},j.createRemoveEmptyScopeFromSetError=function(e){return new j(D.code,D.desc+" Given Scope: "+e)},j.createAppendScopeSetError=function(e){return new j(L.code,L.desc+" Detail Error: "+e)},j.createEmptyInputScopeSetError=function(e){return new j(M.code,M.desc+" Given ScopeSet: "+e)},j);function j(e,t){var r=y.call(this,e,t)||this;return r.name="ClientAuthError",Object.setPrototypeOf(r,j.prototype),r}var G,K,F=(W.decodeJwt=function(e){if(W.isEmpty(e))throw H.createIdTokenNullOrEmptyError(e);var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw H.createIdTokenParsingError("Given token is malformed: "+JSON.stringify(e));return{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},W.isEmpty=function(e){return void 0===e||!e||0===e.length},W.queryStringToObject=function(e){function t(e){return decodeURIComponent(e.replace(o," "))}var r,o=/\+/g,n=/([^&=]+)=([^&]*)/g,i={};for(r=n.exec(e);r;)i[t(r[1])]=t(r[2]),r=n.exec(e);return i},W.trimAndConvertArrayEntriesToLowerCase=function(e){return e.map(function(e){return e.trim().toLowerCase()})},W.removeEmptyStringsFromArray=function(e){return e.filter(function(e){return!W.isEmpty(e)})},W);function W(){}(K=G=G||{})[K.Error=0]="Error",K[K.Warning=1]="Warning",K[K.Info=2]="Info",K[K.Verbose=3]="Verbose";var z=(J.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),o=(F.isEmpty(this.correlationId)?"["+r+"] : ":"["+r+"] : ["+this.correlationId+"]")+" : "+m+" : "+G[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,o,t.containsPii)}},J.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},J.prototype.error=function(e,t){this.logMessage(e,{logLevel:G.Error,containsPii:!1,correlationId:t||""})},J.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:G.Error,containsPii:!0,correlationId:t||""})},J.prototype.warning=function(e,t){this.logMessage(e,{logLevel:G.Warning,containsPii:!1,correlationId:t||""})},J.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:G.Warning,containsPii:!0,correlationId:t||""})},J.prototype.info=function(e,t){this.logMessage(e,{logLevel:G.Info,containsPii:!1,correlationId:t||""})},J.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:G.Info,containsPii:!0,correlationId:t||""})},J.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:G.Verbose,containsPii:!1,correlationId:t||""})},J.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:G.Verbose,containsPii:!0,correlationId:t||""})},J.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},J);function J(e){this.level=G.Info,e&&(this.localCallback=e.loggerCallback,this.piiLoggingEnabled=e.piiLoggingEnabled,this.level=e.logLevel)}var Q={tokenRenewalOffsetSeconds:300,telemetry:null},V={loggerCallback:function(){throw d.createUnexpectedError("Logger - loggerCallbackInterface() has not been implemented.")},piiLoggingEnabled:!1,logLevel:G.Info},B={clear:function(){throw d.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")},containsKey:function(){throw d.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},getItem:function(){throw d.createUnexpectedError("Storage interface - getItem() has not been implemented for the cacheStorage interface.")},getKeys:function(){throw d.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},removeItem:function(){throw d.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},setItem:function(){throw d.createUnexpectedError("Storage interface - setItem() has not been implemented for the cacheStorage interface.")}},Y={sendGetRequestAsync:function(){return p(this,void 0,void 0,function(){return f(this,function(e){throw"Network interface - sendGetRequestAsync() has not been implemented",d.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")})})},sendPostRequestAsync:function(){return p(this,void 0,void 0,function(){return f(this,function(e){throw"Network interface - sendPostRequestAsync() has not been implemented",d.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")})})}},X={createNewGuid:function(){throw d.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw d.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw d.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return p(this,void 0,void 0,function(){return f(this,function(e){throw"Crypto interface - generatePkceCodes() has not been implemented",d.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")})})}};function Z(e){var t=e.systemOptions,r=e.loggerOptions,o=e.storageInterface,n=e.networkInterface,i=e.cryptoInterface;return{systemOptions:t||Q,loggerOptions:r||V,storageInterface:o||B,networkInterface:n||Y,cryptoInterface:i||X}}var $,ee,te,re,oe,ne=function(e,t){this.key=e,this.value=t},ie="MSAL.JS",ce="msal",se="https://login.microsoftonline.com/common",ae="https://login.microsoftonline.com/common/discovery/instance",ue="|",he="NO_ACCOUNT",pe="claims",de="openid",le="profile",fe="offline_access",ge="code",ye="authorization_code",me="refresh_token",we="fragment",Ee="S256",ve="application/x-www-form-urlencoded";($||($={})).CONTENT_TYPE="Content-Type",(te=ee=ee||{}).AUTHORITY="authority",te.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",te.SESSION_STATE="session.state",te.REQUEST_STATE="request.state",te.NONCE_IDTOKEN="nonce.idtoken",te.ORIGIN_URI="request.origin",te.RENEW_STATUS="token.renew.status",te.URL_HASH="urlHash",te.REQUEST_PARAMS="request.params",te.SCOPES="scopes",(oe=re=re||{}).ID_TOKEN="idtoken",oe.CLIENT_INFO="client.info",oe.ADAL_ID_TOKEN="adal.idtoken",oe.ERROR="error",oe.ERROR_DESC="error.description";var Ie,Se,Ce,be,Te,Re,_e=["login.windows.net","login.chinacloudapi.cn","login.cloudgovapi.us","login.microsoftonline.com","login.microsoftonline.de","login.microsoftonline.us"];(Se=Ie=Ie||{}).COMMON="common",Se.ORGANIZATIONS="organizations",Se.CONSUMERS="consumers",(be=Ce=Ce||{}).CLIENT_ID="client_id",be.RESOURCE="resource",be.REDIRECT_URI="redirect_uri",be.RESPONSE_TYPE="response_type",be.RESPONSE_MODE="response_mode",be.GRANT_TYPE="grant_type",be.CLAIMS="claims",be.SCOPE="scope",be.ERROR="error",be.ERROR_DESCRIPTION="error_description",be.ACCESS_TOKEN="access_token",be.ID_TOKEN="id_token",be.REFRESH_TOKEN="refresh_token",be.EXPIRES_IN="expires_in",be.STATE="state",be.NONCE="nonce",be.PROMPT="prompt",be.SESSION_STATE="session_state",be.CLIENT_INFO="client_info",be.CODE="code",be.CODE_CHALLENGE="code_challenge",be.CODE_CHALLENGE_METHOD="code_challenge_method",be.CODE_VERIFIER="code_verifier",be.CLIENT_REQUEST_ID="client-request-id",be.X_CLIENT_SKU="x-client-SKU",be.X_CLIENT_VER="x-client-Ver",be.POST_LOGOUT_URI="post_logout_redirect_uri",(Re=Te=Te||{}).ISSUER="iss",Re.OBJID="oid",Re.SUBJECT="sub",Re.TENANTID="tid",Re.VERSION="ver",Re.PREF_USERNAME="preferred_username",Re.NAME="name",Re.NONCE="nonce",Re.EXPIRATION="exp",Re.HOME_OBJID="home_oid",Re.SESSIONID="sid",Re.CLOUD_INSTANCE_HOSTNAME="cloud_instance_host_name";var Oe,ke,Ae={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"};(ke=Oe=Oe||{}).ACCOUNT="account",ke.SID="sid",ke.LOGIN_HINT="login_hint",ke.ID_TOKEN="id_token",ke.DOMAIN_HINT="domain_hint",ke.ORGANIZATIONS="organizations",ke.CONSUMERS="consumers",ke.ACCOUNT_ID="accountIdentifier",ke.HOMEACCOUNT_ID="homeAccountIdentifier";var Ne=[Oe.SID,Oe.LOGIN_HINT],Pe=(Ue.prototype.generateAcquireTokenAccountKey=function(e){return""+ee.ACQUIRE_TOKEN_ACCOUNT+ue+e},Ue.prototype.generateAuthorityKey=function(e){return""+ee.AUTHORITY+ue+e},Ue.prototype.generateNonceKey=function(e){return""+ee.NONCE_IDTOKEN+ue+e},Ue.prototype.setAccountCache=function(e){var t=e&&e.homeAccountIdentifier?e.homeAccountIdentifier:he,r=this.generateAcquireTokenAccountKey(t);this.cacheStorage.setItem(r,JSON.stringify(e))},Ue.prototype.setAuthorityCache=function(e,t){var r=this.generateAuthorityKey(t);this.cacheStorage.setItem(r,e.canonicalAuthority)},Ue.prototype.updateCacheEntries=function(e,t){t&&this.setAccountCache(t),this.cacheStorage.setItem(ee.REQUEST_STATE,e.state),this.cacheStorage.setItem(this.generateNonceKey(e.state),e.nonce),this.setAuthorityCache(e.authorityInstance,e.state)},Ue.prototype.resetTempCacheItems=function(r){var o=this;this.cacheStorage.getKeys().forEach(function(e){if(!F.isEmpty(r)&&-1!==e.indexOf(r)){var t=e.split(ue);(1<t.length?t[t.length-1]:null)===r&&o.cacheStorage.removeItem(e)}}),this.cacheStorage.removeItem(ee.REQUEST_STATE),this.cacheStorage.removeItem(ee.REQUEST_PARAMS),this.cacheStorage.removeItem(ee.ORIGIN_URI)},Ue.prototype.getAllAccessTokens=function(i,c,s,a){var u=this;return this.cacheStorage.getKeys().reduce(function(e,t){if(t.match(i)&&t.match(c)&&t.match(s)&&t.match(a)){var r=u.cacheStorage.getItem(t);if(r)try{var o=JSON.parse(t);if(u.checkForExactKeyMatch(o,i,c,s,a)){var n=new ne(o,JSON.parse(r));return e.concat([n])}}catch(e){throw H.createCacheParseError(t)}}return e},[])},Ue.prototype.removeAllAccessTokens=function(r,o,n,i){var c=this;this.cacheStorage.getKeys().forEach(function(t){if(t.match(r)&&t.match(o)&&t.match(n)&&t.match(i))try{var e=JSON.parse(t);c.checkForExactKeyMatch(e,r,o,n,i)&&c.cacheStorage.removeItem(t)}catch(e){throw H.createCacheParseError(t)}})},Ue.prototype.checkForExactKeyMatch=function(e,t,r,o,n){var i=e.clientId===t,c=F.isEmpty(r)||e.authority===r,s=F.isEmpty(o)||e.resource===o,a=F.isEmpty(n)||e.homeAccountIdentifier===n;return i&&c&&s&&a},Ue);function Ue(e){this.cacheStorage=e}var qe=(xe.createAccount=function(e,t,r){var o,n=e.claims.oid||e.claims.sub,i=t?t.uid:"",c=t?t.utid:"";return F.isEmpty(i)||F.isEmpty(c)||(o=r.base64Encode(i)+"."+r.base64Encode(c)),new xe(n,o,e.claims,e.rawIdToken)},xe.compareAccounts=function(e,t){return!!(e&&e.homeAccountIdentifier&&t&&t.homeAccountIdentifier)&&e.homeAccountIdentifier===t.homeAccountIdentifier},xe);function xe(e,t,r,o){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=r.preferred_username,this.name=r.name,this.idToken=o,this.idTokenClaims=r,this.sid=r.sid,this.environment=r.iss}var De=(Le.extractIdToken=function(e,t){var r=F.decodeJwt(e);if(!r)return null;try{var o=r.JWSPayload,n=t.base64Decode(o);return JSON.parse(n)}catch(e){throw H.createIdTokenParsingError(JSON.stringify(e))}},Le);function Le(e,t){if(F.isEmpty(e))throw H.createIdTokenNullOrEmptyError(e);this.rawIdToken=e,this.claims=Le.extractIdToken(e,t)}function Me(e,t){if(F.isEmpty(e))throw H.createClientInfoEmptyError(e);try{var r=t.base64Decode(e);return JSON.parse(r)}catch(e){throw H.createClientInfoDecodingError(e)}}var He=(je.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(re.ID_TOKEN),t=this.cacheStorage.getItem(re.CLIENT_INFO);if(F.isEmpty(e)||F.isEmpty(t))return null;var r=new De(e,this.cryptoObj),o=Me(t,this.cryptoObj);return this.account=qe.createAccount(r,o,this.cryptoObj),this.account},je);function je(e){this.config=Z(e),this.logger=new z(this.config.loggerOptions),this.cryptoObj=this.config.cryptoInterface,this.cacheStorage=this.config.storageInterface,this.cacheManager=new Pe(this.cacheStorage),this.networkClient=this.config.networkInterface}var Ge={clientId:"",authority:null,redirectUri:"",postLogoutRedirectUri:""};var Ke,Fe={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},We={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},ze={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},Je={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},Qe={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},Ve={code:"empty_url_error",desc:"URL was empty or null."},Be={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},Ye={code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},Xe={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},Ze={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'.  Please see here for valid configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},$e={code:"token_request_empty",desc:"Token request was empty and not found in cache."},et=(r(tt,Ke=H),tt.createRedirectUriEmptyError=function(){return new tt(Fe.code,Fe.desc)},tt.createPostLogoutRedirectUriEmptyError=function(){return new tt(We.code,We.desc)},tt.createClaimsRequestParsingError=function(e){return new tt(ze.code,ze.desc+" Given value: "+e)},tt.createInsecureAuthorityUriError=function(e){return new tt(Je.code,Je.desc+" Given URI: "+e)},tt.createUrlParseError=function(e){return new tt(Qe.code,Qe.desc+" Given Error: "+e)},tt.createUrlEmptyError=function(){return new tt(Ve.code,Ve.desc)},tt.createScopesNonArrayError=function(e){return new tt(Ye.code,Ye.desc+" Given Scopes: "+e)},tt.createEmptyScopesArrayError=function(e){return new tt(Be.code,Be.desc+" Given Scopes: "+e)},tt.createClientIdSingleScopeError=function(e){return new tt(Xe.code,Xe.desc+" Given Scopes: "+e)},tt.createInvalidPromptError=function(e){return new tt(Ze.code,Ze.desc+" Given value: "+e)},tt.createEmptyTokenRequestError=function(){return new tt($e.code,$e.desc)},tt);function tt(e,t){var r=Ke.call(this,e,t)||this;return r.name="ClientConfigurationError",Object.setPrototypeOf(r,tt.prototype),r}var rt=(ot.fromString=function(e,t,r){return new ot((e=e||"").split(" "),t,r)},ot.prototype.replaceDefaultScopes=function(){this.scopes.has(this.clientId)&&(this.removeScope(this.clientId),this.appendScope(de),this.appendScope(le)),this.appendScope(fe)},ot.prototype.validateInputScopes=function(e){if(this.scopesRequired&&(!e||e.length<1))throw et.createEmptyScopesArrayError(e);if(!Array.isArray(e))throw et.createScopesNonArrayError(e)},ot.prototype.containsScope=function(e){return!F.isEmpty(e)&&this.scopes.has(e)},ot.prototype.containsScopeSet=function(e){var t=this;return!!e&&this.scopes.size>=e.scopes.size&&e.asArray().every(function(e){return t.containsScope(e)})},ot.prototype.appendScope=function(e){if(F.isEmpty(e))throw H.createAppendEmptyScopeToSetError(e);this.scopes.add(e.trim().toLowerCase())},ot.prototype.appendScopes=function(e){try{var t=new ot(e,this.clientId,this.scopesRequired);this.scopes=this.unionScopeSets(t)}catch(e){throw H.createAppendScopeSetError(e)}},ot.prototype.removeScope=function(e){if(F.isEmpty(e))throw H.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim().toLowerCase())},ot.prototype.unionScopeSets=function(e){if(!e)throw H.createEmptyInputScopeSetError(e);return new Set(i(e.asArray(),Array.from(this.scopes)))},ot.prototype.intersectingScopeSets=function(e){if(!e)throw H.createEmptyInputScopeSetError(e);return this.unionScopeSets(e).size<this.scopes.size+e.getScopeCount()},ot.prototype.getScopeCount=function(){return this.scopes.size},ot.prototype.isLoginScopeSet=function(){var e=this.originalScopes.has(this.clientId)||this.originalScopes.has(de)||this.originalScopes.has(le);return this.originalScopes&&e},ot.prototype.asArray=function(){return Array.from(this.scopes)},ot.prototype.getOriginalScopesAsArray=function(){return Array.from(this.originalScopes)},ot.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):""},ot);function ot(e,t,r){this.clientId=t,this.scopesRequired=r;var o=e?F.removeEmptyStringsFromArray(e):e;this.validateInputScopes(o);var n=o?F.trimAndConvertArrayEntriesToLowerCase(i(o)):[];this.scopes=new Set(n),this.scopesRequired||this.appendScope(this.clientId),this.originalScopes=new Set(this.scopes),this.replaceDefaultScopes()}var nt=(it.setRequestState=function(e,t){return F.isEmpty(e)?t:""+t+ue+e},it.getUserRequestState=function(e){if(!F.isEmpty(e)){var t=e.indexOf(ue);if(-1<t&&t+1<e.length)return e.substring(t+1)}return""},it);function it(){}var ct=(st.prototype.appendExtraScopes=function(){this.userRequest&&this.scopes&&this.userRequest.extraScopesToConsent&&this.scopes.appendScopes(this.userRequest.extraScopesToConsent)},st.prototype.hasSSOParam=function(){var e=this.userRequest&&(this.account||this.userRequest.sid||this.userRequest.loginHint);return!!this.account||!!e},st.prototype.addSSOQueryParameters=function(e){var t={};return this.account?this.account.sid&&this.userRequest&&this.userRequest.prompt===Ae.NONE?t[Oe.SID]=this.account.sid:this.account.userName&&(t[Oe.LOGIN_HINT]=this.account.userName):this.userRequest&&(this.userRequest.sid&&this.userRequest.prompt===Ae.NONE?t[Oe.SID]=this.userRequest.sid:this.userRequest.loginHint&&(t[Oe.LOGIN_HINT]=this.userRequest.loginHint)),e&&F.isEmpty(t[Oe.SID])&&F.isEmpty(t[Oe.LOGIN_HINT])&&e.claims&&e.claims.upn&&(t[Oe.LOGIN_HINT]=e.claims.upn),t},st.prototype.populateQueryParams=function(e){var t,r={};this.userRequest&&(this.userRequest.prompt&&this.validatePromptParameter(this.userRequest.prompt),this.userRequest.claimsRequest&&function(e){if(e.claimsRequest)try{JSON.parse(e.claimsRequest)}catch(e){throw et.createClaimsRequestParsingError(e)}}(this.userRequest)),(this.hasSSOParam()||e)&&(r=this.addSSOQueryParameters(e)),this.userRequest&&(t=this.sanitizeEQParams(this.userRequest,r)),this.queryParameters=this.generateQueryParametersString(r),this.extraQueryParameters=this.generateQueryParametersString(t)},st.prototype.createNavigateUrl=function(){return p(this,void 0,void 0,function(){var t,r;return f(this,function(e){switch(e.label){case 0:return[4,this.createParamString()];case 1:return t=e.sent(),(r=this.authorityInstance.authorizationEndpoint).indexOf("?")<0?r+="?":r+="&",[2,""+r+t.join("&")]}})})},st.prototype.createParamString=function(){return p(this,void 0,void 0,function(){var t,r;return f(this,function(e){switch(e.label){case 0:return(t=[]).push(Ce.RESPONSE_TYPE+"="+this.responseType),t.push(Ce.SCOPE+"="+encodeURIComponent(this.scopes.printScopes())),t.push(Ce.CLIENT_ID+"="+encodeURIComponent(this.clientId)),t.push(Ce.REDIRECT_URI+"="+encodeURIComponent(this.redirectUri)),t.push(Ce.STATE+"="+encodeURIComponent(this.state)),t.push(Ce.NONCE+"="+encodeURIComponent(this.nonce)),t.push(Ce.CLIENT_INFO+"=1"),t.push(Ce.X_CLIENT_SKU+"="+this.xClientSku),t.push(Ce.X_CLIENT_VER+"="+this.xClientVer),[4,(r=this).cryptoObj.generatePkceCodes()];case 1:return r.generatedPkce=e.sent(),t.push(Ce.CODE_CHALLENGE+"="+encodeURIComponent(this.generatedPkce.challenge)),t.push(Ce.CODE_CHALLENGE_METHOD+"="+Ee),this.userRequest&&this.userRequest.resource&&t.push(Ce.RESOURCE+"="+encodeURIComponent(this.userRequest.resource)),this.userRequest&&this.userRequest.prompt&&t.push(Ce.PROMPT+"="+encodeURIComponent(this.userRequest.prompt)),this.userRequest&&this.userRequest.claimsRequest&&t.push(Ce.CLAIMS+"="+encodeURIComponent(this.userRequest.claimsRequest)),this.queryParameters&&t.push(this.queryParameters),this.extraQueryParameters&&t.push(this.extraQueryParameters),t.push(Ce.CLIENT_REQUEST_ID+"="+encodeURIComponent(this.correlationId)),t.push(Ce.RESPONSE_MODE+"="+we),[2,t]}})})},st.prototype.validatePromptParameter=function(e){if([Ae.LOGIN,Ae.SELECT_ACCOUNT,Ae.CONSENT,Ae.NONE].indexOf(e)<0)throw et.createInvalidPromptError(e)},st.prototype.sanitizeEQParams=function(e,t){var r=e.extraQueryParameters;return r?(e.claimsRequest&&delete r[pe],Ne.forEach(function(e){r[e]&&delete r[e]}),Object.keys(t).forEach(function(e){r[e]&&delete r[e],e===Oe.SID&&delete r[Oe.DOMAIN_HINT]}),r):null},st.prototype.generateQueryParametersString=function(t){var r="";return t&&Object.keys(t).forEach(function(e){F.isEmpty(r)?r=e+"="+encodeURIComponent(t[e]):r+="&"+e+"="+encodeURIComponent(t[e])}),r},st);function st(e,t,r,o,n,i,c){this.clientId=t,this.cryptoObj=i,this.redirectUri=n,this.xClientSku=ie,this.xClientVer=m,this.authorityInstance=e,this.userRequest=r,this.responseType=ge,this.account=r&&r.account||o,this.scopes=new rt(this.userRequest&&this.userRequest.scopes||[],this.clientId,!c),c&&this.appendExtraScopes();var s=this.cryptoObj.createNewGuid();this.state=nt.setRequestState(this.userRequest&&this.userRequest.userRequestState,s),this.nonce=this.cryptoObj.createNewGuid(),this.correlationId=this.userRequest.correlationId||this.cryptoObj.createNewGuid()}var at=(ut.prototype.createRequestHeaders=function(){var e=new Map;return e.set($.CONTENT_TYPE,ve),e},ut.prototype.createRequestBody=function(){return this.createParamString().join("&")},ut.prototype.createParamString=function(){var e=[];if(e.push(Ce.CLIENT_ID+"="+encodeURIComponent(this.clientId)),e.push(Ce.SCOPE+"="+encodeURIComponent(this.scopes.printScopes())),e.push(Ce.REDIRECT_URI+"="+encodeURIComponent(this.redirectUri)),this.codeResponse)e.push(Ce.CODE+"="+encodeURIComponent(this.codeResponse.code)),e.push(Ce.CODE_VERIFIER+"="+encodeURIComponent(this.tokenRequest.codeVerifier)),e.push(Ce.GRANT_TYPE+"="+ye);else{if(F.isEmpty(this.refreshToken))throw H.createTokenRequestCannotBeMadeError();e.push(Ce.REFRESH_TOKEN+"="+this.refreshToken),e.push(Ce.GRANT_TYPE+"="+me)}return e},ut);function ut(e,t,r,o,n,i){this.clientId=e,this.cryptoObj=n,this.redirectUri=o,this.xClientSku=ie,this.xClientVer=m,this.tokenRequest=t,this.codeResponse=r,this.refreshToken=i,this.scopes=new rt(this.tokenRequest&&this.tokenRequest.scopes||[],this.clientId,!0),this.correlationId=this.tokenRequest.correlationId||this.cryptoObj.createNewGuid()}var ht=(pt.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},pt);function pt(){}var dt=(Object.defineProperty(lt.prototype,"urlString",{get:function(){return this._urlString},enumerable:!0,configurable:!0}),lt.prototype.canonicalizeUri=function(e){return(e=e&&e.toLowerCase())&&!e.endsWith("/")&&(e+="/"),e},lt.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw et.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments||e.PathSegments.length<1)throw et.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw et.createInsecureAuthorityUriError(this.urlString)},lt.prototype.urlRemoveQueryStringParameter=function(e){var t=new RegExp("(\\&"+e+"=)[^&]+");return this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+&"),this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+"),this._urlString=this.urlString.replace(t,""),this.urlString},lt.prototype.replaceTenantPath=function(e){var t=this.getUrlComponents(),r=t.PathSegments;return!e||0===r.length||r[0]!==Ie.COMMON&&r[0]!==Ie.ORGANIZATIONS||(r[0]=e),lt.constructAuthorityUriFromObject(t)},lt.prototype.getHash=function(){var e=this.urlString.indexOf("#"),t=this.urlString.indexOf("#/");return-1<t?this.urlString.substring(t+2):-1<e?this.urlString.substring(e+1):""},lt.prototype.getDeserializedHash=function(){var e=this.getHash(),t=F.queryStringToObject(e);if(!t)throw H.createHashNotDeserializedError(JSON.stringify(t));return t},lt.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw et.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5]},o=r.AbsolutePath.split("/");return o=o.filter(function(e){return e&&0<e.length}),r.PathSegments=o,r},lt.constructAuthorityUriFromObject=function(e){return new lt(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))},lt.hashContainsKnownProperties=function(e){if(F.isEmpty(e))return!1;var t=new lt(e).getDeserializedHash();return!!(t.error_description||t.error||t.state)},lt);function lt(e){if(this._urlString=e,!F.isEmpty(this._urlString)&&F.isEmpty(this.getHash()))this._urlString=this.canonicalizeUri(e);else if(F.isEmpty(this._urlString))throw et.createUrlEmptyError()}var ft,gt=function(e,t,r,o,n,i,c){var s=new dt(e);this.authority=s.urlString,this.clientId=t,this.scopes=r,this.resource=o,F.isEmpty(n)||F.isEmpty(i)||(this.homeAccountIdentifier=c.base64Encode(n)+"."+c.base64Encode(i))},yt=function(e,t,r,o,n,i){this.tokenType=e,this.accessToken=t,this.idToken=r,this.refreshToken=o,this.expiresOnSec=n,this.extExpiresOnSec=i},mt=(r(wt,ft=d),wt);function wt(e,t){var r=ft.call(this,e,t)||this;return r.name="ServerError",Object.setPrototypeOf(r,wt.prototype),r}var Et=(vt.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var r=Number(t.claims.exp);return r&&!e.expiresOn&&(e.expiresOn=new Date(1e3*r)),g(g({},e),{idToken:t.rawIdToken,idTokenClaims:t.claims,uniqueId:t.claims.oid||t.claims.sub,tenantId:t.claims.tid})},vt.prototype.handleServerCodeResponse=function(t){try{return this.validateServerAuthorizationCodeResponse(t,this.cacheStorage.getItem(ee.REQUEST_STATE),this.cryptoObj),t.client_info&&this.cacheStorage.setItem(re.CLIENT_INFO,t.client_info),{code:t.code,userRequestState:t.state}}catch(e){throw this.cacheManager.resetTempCacheItems(t&&t.state),e}},vt.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(e.state!==t)throw H.createStateMismatchError();if(e.error||e.error_description)throw new mt(e.error,e.error_description);e.client_info&&Me(e.client_info,r)},vt.prototype.validateServerAuthorizationTokenResponse=function(e){if(e.error||e.error_description){var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new mt(e.error,t)}},vt.prototype.saveToken=function(e,t,r,o,n){var i=this,c=rt.fromString(o.scope,this.clientId,!0),s=c.asArray(),a=o.expires_in,u=ht.nowSeconds()+a,h=u+o.ext_expires_in;F.isEmpty(e.idToken)||this.cacheStorage.setItem(re.ID_TOKEN,e.idToken);var p=new yt(o.token_type,o.access_token,e.idToken,o.refresh_token,u.toString(),h.toString()),d=e.account&&e.account.homeAccountIdentifier,l=this.cacheManager.getAllAccessTokens(this.clientId,t||"",r||"",d||"");if(l.length<1){this.logger.info("No tokens found, creating new item.");var f=new gt(t,this.clientId,o.scope,r,n&&n.uid,n&&n.utid,this.cryptoObj);this.cacheStorage.setItem(JSON.stringify(f),JSON.stringify(p))}else l.forEach(function(e){var t=rt.fromString(e.key.scopes,i.clientId,!0);t.intersectingScopeSets(c)&&(i.cacheStorage.removeItem(JSON.stringify(e.key)),t.appendScopes(s),e.key.scopes=t.printScopes(),F.isEmpty(p.idToken)&&(p.idToken=e.value.idToken),i.cacheStorage.setItem(JSON.stringify(e.key),JSON.stringify(p)))});return g(g({},e),{tokenType:o.token_type,scopes:s,accessToken:o.access_token,refreshToken:o.refresh_token,expiresOn:new Date(1e3*u)})},vt.prototype.getCachedAccount=function(e){try{return JSON.parse(this.cacheStorage.getItem(e))}catch(e){return this.logger.warning("Account could not be parsed: "+JSON.stringify(e)),null}},vt.prototype.createTokenResponse=function(e,t,r,o){var n,i={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",refreshToken:"",scopes:[],expiresOn:null,account:null,userRequestState:""},c=this.cacheStorage.getItem(re.ID_TOKEN);if(e.id_token){if(n=new De(e.id_token,this.cryptoObj),i=vt.setResponseIdToken(i,n),!F.isEmpty(o)){if(this.logger.info("State was detected - nonce should be available."),F.isEmpty(n.claims.nonce))throw H.createInvalidIdTokenError(n);var s=this.cacheStorage.getItem(this.cacheManager.generateNonceKey(o));if(n.claims.nonce!==s)throw H.createNonceMismatchError()}}else c?(n=new De(c,this.cryptoObj),i=vt.setResponseIdToken(i,n)):n=null;var a=null,u=null;if(n){a=Me(this.cacheStorage.getItem(re.CLIENT_INFO),this.cryptoObj),i.account=qe.createAccount(n,a,this.cryptoObj);var h=this.cacheManager.generateAcquireTokenAccountKey(i.account.homeAccountIdentifier);u=this.getCachedAccount(h)}if(i.userRequestState=nt.getUserRequestState(o),this.cacheManager.resetTempCacheItems(o),u&&i.account&&!qe.compareAccounts(u,i.account))throw this.logger.error("Accounts do not match."),this.logger.errorPii("Cached Account: "+JSON.stringify(u)+", New Account: "+JSON.stringify(i.account)),H.createAccountMismatchError();return this.saveToken(i,t,r,e,a)},vt);function vt(e,t,r,o,n){this.clientId=e,this.cacheStorage=t,this.cacheManager=r,this.cryptoObj=o,this.logger=n}var It,St,Ct=(Object.defineProperty(bt.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new dt(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(bt.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(bt.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(bt.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.authorization_endpoint);throw H.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(bt.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.token_endpoint);throw H.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(bt.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.end_session_endpoint);throw H.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(bt.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.issuer);throw H.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),bt.prototype.replaceTenant=function(e){return e.replace("{tenant}",this.tenant)},Object.defineProperty(bt.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),bt.prototype.discoveryComplete=function(){return!!this.tenantDiscoveryResponse},bt.prototype.discoverEndpoints=function(t){return p(this,void 0,void 0,function(){return f(this,function(e){return[2,this.networkInterface.sendGetRequestAsync(t)]})})},bt.prototype.resolveEndpointsAsync=function(){return p(this,void 0,void 0,function(){var t,r;return f(this,function(e){switch(e.label){case 0:return[4,this.getOpenIdConfigurationEndpointAsync()];case 1:return t=e.sent(),[4,(r=this).discoverEndpoints(t)];case 2:return r.tenantDiscoveryResponse=e.sent(),[2]}})})},bt);function bt(e,t){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t}(St=It=It||{})[St.Aad=0]="Aad",St[St.Adfs=1]="Adfs",St[St.B2C=2]="B2C";var Tt,Rt=(r(_t,Tt=Ct),Object.defineProperty(_t.prototype,"authorityType",{get:function(){return It.Aad},enumerable:!0,configurable:!0}),Object.defineProperty(_t.prototype,"aadInstanceDiscoveryEndpointUrl",{get:function(){return ae+"?api-version=1.0&authorization_endpoint="+this.canonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),_t.prototype.getOpenIdConfigurationEndpointAsync=function(){return p(this,void 0,void 0,function(){return f(this,function(e){switch(e.label){case 0:return this.isInTrustedHostList(this.canonicalAuthorityUrlComponents.HostNameAndPort)?[2,this.defaultOpenIdConfigurationEndpoint]:[4,this.networkInterface.sendGetRequestAsync(this.aadInstanceDiscoveryEndpointUrl)];case 1:return[2,e.sent().tenant_discovery_endpoint]}})})},_t.prototype.isInTrustedHostList=function(e){return _e.includes(e)},_t);function _t(e,t){return Tt.call(this,e,t)||this}var Ot=(kt.detectAuthorityFromUrl=function(e){switch(new dt(e).getUrlComponents().PathSegments[0]){case"tfp":return It.B2C;default:return It.Aad}},kt.createInstance=function(e,t){if(F.isEmpty(e))throw et.createUrlEmptyError();switch(kt.detectAuthorityFromUrl(e)){case It.Aad:return new Rt(e,t);default:throw H.createInvalidAuthorityTypeError("Given Url: "+e)}},kt);function kt(){}var At,Nt=(r(Pt,At=He),Pt.prototype.createLoginUrl=function(t){return p(this,void 0,void 0,function(){return f(this,function(e){return[2,this.createUrl(t,!0)]})})},Pt.prototype.createAcquireTokenUrl=function(t){return p(this,void 0,void 0,function(){return f(this,function(e){return[2,this.createUrl(t,!1)]})})},Pt.prototype.createUrl=function(u,h){return p(this,void 0,void 0,function(){var t,r,o,n,i,c,s,a;return f(this,function(e){switch(e.label){case 0:t=u&&u.authority?Ot.createInstance(u.authority,this.networkClient):this.defaultAuthorityInstance,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,t.resolveEndpointsAsync()];case 2:return e.sent(),[3,4];case 3:throw r=e.sent(),H.createEndpointDiscoveryIncompleteError(r);case 4:return e.trys.push([4,6,,7]),o=new ct(t,this.clientConfig.auth.clientId,u,this.getAccount(),this.getRedirectUri(),this.cryptoObj,h),n=null,o.hasSSOParam()||(i=this.cacheStorage.getItem(re.ADAL_ID_TOKEN),F.isEmpty(i)||(n=new De(i,this.cryptoObj),this.cacheStorage.removeItem(re.ADAL_ID_TOKEN))),this.cacheManager.updateCacheEntries(o,u.account),o.populateQueryParams(n),[4,o.createNavigateUrl()];case 5:return c=e.sent(),s={scopes:o.scopes.getOriginalScopesAsArray(),resource:u.resource,codeVerifier:o.generatedPkce.verifier,extraQueryParameters:u.extraQueryParameters,authority:o.authorityInstance.canonicalAuthority,correlationId:o.correlationId},this.cacheStorage.setItem(ee.REQUEST_PARAMS,this.cryptoObj.base64Encode(JSON.stringify(s))),[2,c];case 6:throw a=e.sent(),this.cacheManager.resetTempCacheItems(o&&o.state),a;case 7:return[2]}})})},Pt.prototype.acquireToken=function(s){return p(this,void 0,void 0,function(){var t,r,o,n,i,c;return f(this,function(e){switch(e.label){case 0:if(e.trys.push([0,6,,7]),!s||F.isEmpty(s.code))throw H.createTokenRequestCannotBeMadeError();if(t=this.getCachedRequest(s.userRequestState),(r=t&&t.authority?Ot.createInstance(t.authority,this.networkClient):this.defaultAuthorityInstance).discoveryComplete())return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,r.resolveEndpointsAsync()];case 2:return e.sent(),[3,4];case 3:throw o=e.sent(),H.createEndpointDiscoveryIncompleteError(o);case 4:return n=r.tokenEndpoint,i=new at(this.clientConfig.auth.clientId,t,s,this.getRedirectUri(),this.cryptoObj),[4,this.getTokenResponse(n,i,t,s)];case 5:return[2,e.sent()];case 6:throw c=e.sent(),this.cacheManager.resetTempCacheItems(s&&s.userRequestState),this.account=null,c;case 7:return[2]}})})},Pt.prototype.renewToken=function(l){return p(this,void 0,void 0,function(){var t,r,o,n,i,c,s,a,u,h,p,d;return f(this,function(e){switch(e.label){case 0:if(e.trys.push([0,8,,9]),!l)throw et.createEmptyTokenRequestError();if(t=l.account||this.getAccount(),(r=new rt(l.scopes||[],this.clientConfig.auth.clientId,!0)).isLoginScopeSet()&&!t)throw H.createUserLoginRequiredError();if((o=l.authority?Ot.createInstance(l.authority,this.networkClient):this.defaultAuthorityInstance).discoveryComplete())return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,o.resolveEndpointsAsync()];case 2:return e.sent(),[3,4];case 3:throw n=e.sent(),H.createEndpointDiscoveryIncompleteError(n);case 4:return i=this.getCachedTokens(r,o.canonicalAuthority,l.resource,t&&t.homeAccountIdentifier),c=Number(i.value.expiresOnSec),s=ht.nowSeconds()+this.clientConfig.systemOptions.tokenRenewalOffsetSeconds,!l.forceRefresh&&c&&s<c?(a=rt.fromString(i.key.scopes,this.clientConfig.auth.clientId,!0),u={uniqueId:"",tenantId:"",scopes:a.asArray(),tokenType:i.value.tokenType,idToken:"",idTokenClaims:null,accessToken:i.value.accessToken,refreshToken:i.value.refreshToken,expiresOn:new Date(1e3*c),account:t,userRequestState:""},[2,F.isEmpty(i.value.idToken)?u:Et.setResponseIdToken(u,new De(i.value.idToken,this.cryptoObj))]):[3,5];case 5:return l.authority=i.key.authority,h=o.tokenEndpoint,p=new at(this.clientConfig.auth.clientId,l,null,this.getRedirectUri(),this.cryptoObj,i.value.refreshToken),[4,this.getTokenResponse(h,p,l)];case 6:return[2,e.sent()];case 7:return[3,9];case 8:throw d=e.sent(),this.cacheManager.resetTempCacheItems(),this.account=null,d;case 9:return[2]}})})},Pt.prototype.logout=function(c){return p(this,void 0,void 0,function(){var t,r,o,n,i;return f(this,function(e){switch(e.label){case 0:t=this.getAccount(),r=t?t.homeAccountIdentifier:"",this.cacheManager.removeAllAccessTokens(this.clientConfig.auth.clientId,c,"",r),this.cacheStorage.clear(),this.account=null,o="";try{o="?"+Ce.POST_LOGOUT_URI+"="+encodeURIComponent(this.getPostLogoutRedirectUri())}catch(e){}if((n=c?Ot.createInstance(c,this.networkClient):this.defaultAuthorityInstance).discoveryComplete())return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,n.resolveEndpointsAsync()];case 2:return e.sent(),[3,4];case 3:throw i=e.sent(),H.createEndpointDiscoveryIncompleteError(i);case 4:return[2,""+n.endSessionEndpoint+o]}})})},Pt.prototype.handleFragmentResponse=function(e){var t=new Et(this.clientConfig.auth.clientId,this.cacheStorage,this.cacheManager,this.cryptoObj,this.logger),r=new dt(e).getDeserializedHash();return t.handleServerCodeResponse(r)},Pt.prototype.cancelRequest=function(){var e=this.cacheStorage.getItem(ee.REQUEST_STATE);this.cacheManager.resetTempCacheItems(e||"")},Pt.prototype.getCachedRequest=function(e){try{var t=this.cacheStorage.getItem(ee.REQUEST_PARAMS),r=JSON.parse(this.cryptoObj.base64Decode(t));if(this.cacheStorage.removeItem(ee.REQUEST_PARAMS),F.isEmpty(r.authority)){var o=this.cacheManager.generateAuthorityKey(e),n=this.cacheStorage.getItem(o);r.authority=n}return r}catch(e){throw H.createTokenRequestCacheError(e)}},Pt.prototype.getCachedTokens=function(t,e,r,o){var n=this,i=this.cacheManager.getAllAccessTokens(this.clientConfig.auth.clientId,e||"",r||"",o||"");if(0===i.length)throw H.createNoTokensFoundError(t.printScopes());var c=i.filter(function(e){return rt.fromString(e.key.scopes,n.clientConfig.auth.clientId,!0).containsScopeSet(t)});if(1<c.length)throw H.createMultipleMatchingTokensInCacheError(t.printScopes());if(1===c.length)return c[0];throw H.createNoTokensFoundError(t.printScopes())},Pt.prototype.getTokenResponse=function(n,i,c,s){return p(this,void 0,void 0,function(){var t,r,o;return f(this,function(e){switch(e.label){case 0:return[4,this.networkClient.sendPostRequestAsync(n,{body:i.createRequestBody(),headers:i.createRequestHeaders()})];case 1:return t=e.sent(),(r=new Et(this.clientConfig.auth.clientId,this.cacheStorage,this.cacheManager,this.cryptoObj,this.logger)).validateServerAuthorizationTokenResponse(t),o=r.createTokenResponse(t,c.authority,c.resource,s&&s.userRequestState),this.account=o.account,[2,o]}})})},Pt.prototype.getRedirectUri=function(){if(this.clientConfig.auth.redirectUri){if("function"==typeof this.clientConfig.auth.redirectUri)return this.clientConfig.auth.redirectUri();if(!F.isEmpty(this.clientConfig.auth.redirectUri))return this.clientConfig.auth.redirectUri}throw et.createRedirectUriEmptyError()},Pt.prototype.getPostLogoutRedirectUri=function(){if(this.clientConfig.auth.postLogoutRedirectUri){if("function"==typeof this.clientConfig.auth.postLogoutRedirectUri)return this.clientConfig.auth.postLogoutRedirectUri();if(!F.isEmpty(this.clientConfig.auth.postLogoutRedirectUri))return this.clientConfig.auth.postLogoutRedirectUri}throw et.createPostLogoutRedirectUriEmptyError()},Pt);function Pt(e){var t=At.call(this,{systemOptions:e.systemOptions,loggerOptions:e.loggerOptions,storageInterface:e.storageInterface,networkInterface:e.networkInterface,cryptoInterface:e.cryptoInterface})||this;return t.clientConfig=function(e){var t=e.auth,r=Z({loggerOptions:e.loggerOptions,storageInterface:e.storageInterface,networkInterface:e.networkInterface,cryptoInterface:e.cryptoInterface});return g({auth:g(g({},Ge),t)},r)}(e),t.defaultAuthorityInstance=Ot.createInstance(t.clientConfig.auth.authority||se,t.networkClient),t}var Ut,qt,xt="localStorage",Dt="sessionStorage",Lt="interaction.status",Mt="interaction_in_progress",Ht=483,jt=600,Gt=50;(qt=Ut=Ut||{}).GET="GET",qt.POST="POST";var Kt=(Ft.prototype.sendGetRequestAsync=function(t,r){return s(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,fetch(t,{method:Ut.GET,headers:this.getFetchHeaders(r)})];case 1:return[4,e.sent().json()];case 2:return[2,e.sent()]}})})},Ft.prototype.sendPostRequestAsync=function(r,o){return s(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return t=o&&o.body||"",[4,fetch(r,{method:Ut.POST,headers:this.getFetchHeaders(o),body:t})];case 1:return[4,e.sent().json()];case 2:return[2,e.sent()]}})})},Ft.prototype.getFetchHeaders=function(e){var r=new Headers;return e&&e.headers&&e.headers.forEach(function(e,t){r.append(t,e)}),r},Ft);function Ft(){}var Wt,zt={code:"no_window_object",desc:"No window object detected."},Jt={code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},Qt={code:"crypto_nonexistent",desc:"The crypto object or function is not available."},Vt={code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},Bt={code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},Yt={code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty."},Xt={code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API."},Zt={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},$t={code:"empty_window_error",desc:"window.open returned null or undefined window object."},er={code:"user_cancelled",desc:"User cancelled the flow."},tr={code:"popup_window_timeout",desc:"Popup window token acquisition operation failed due to timeout."},rr={code:"redirect_in_iframe",desc:"Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},or=(t(nr,Wt=d),nr.createNoWindowObjectError=function(){return new nr(zt.code,zt.desc)},nr.createPkceNotGeneratedError=function(e){return new nr(Jt.code,Jt.desc+" Detail:"+e)},nr.createCryptoNotAvailableError=function(e){return new nr(Qt.code,Qt.desc+" Detail:"+e)},nr.createHttpMethodNotImplementedError=function(e){return new nr(Vt.code,Vt.desc+" Given Method: "+e)},nr.createEmptyNavigationUriError=function(){return new nr(Bt.code,Bt.desc)},nr.createEmptyHashError=function(e){return new nr(Yt.code,Yt.desc+" Given Url: "+e)},nr.createInteractionInProgressError=function(){return new nr(Xt.code,Xt.desc)},nr.createPopupWindowError=function(e){var t=Zt.desc;return t=F.isEmpty(e)?t:t+" Details: "+e,new nr(Zt.code,t)},nr.createEmptyWindowCreatedError=function(){return new nr($t.code,$t.desc)},nr.createUserCancelledError=function(){return new nr(er.code,er.desc)},nr.createPopupWindowTimeoutError=function(e){var t="URL navigated to is "+e+", "+tr.desc;return new nr(tr.code,t)},nr.createRedirectInIframeError=function(e){return new nr(rr.code,rr.desc+" (window.parent !== window) => "+e)},nr);function nr(e,t){var r=Wt.call(this,e,t)||this;return Object.setPrototypeOf(r,nr.prototype),r.name="BrowserAuthError",r}var ir=(cr.prototype.sendGetRequestAsync=function(t,r){return s(this,void 0,void 0,function(){return a(this,function(e){return[2,this.sendRequestAsync(t,Ut.GET,r)]})})},cr.prototype.sendPostRequestAsync=function(t,r){return s(this,void 0,void 0,function(){return a(this,function(e){return[2,this.sendRequestAsync(t,Ut.POST,r)]})})},cr.prototype.sendRequestAsync=function(e,n,i){var c=this;return new Promise(function(t,r){var o=new XMLHttpRequest;if(o.open(n,e,!0),c.setXhrHeaders(o,i),o.onload=function(){(o.status<200||300<=o.status)&&r(o.responseText);try{var e=JSON.parse(o.responseText);t(e)}catch(e){r(o.responseText)}},o.onerror=function(){r(o.status)},"POST"===n&&i.body)o.send(i.body);else{if("GET"!==n)throw or.createHttpMethodNotImplementedError(n);o.send()}})},cr.prototype.setXhrHeaders=function(r,e){e&&e.headers&&e.headers.forEach(function(e,t){r.setRequestHeader(t,e)})},cr);function cr(){}var sr=(ar.navigateWindow=function(e,t){t?window.location.replace(e):window.location.assign(e)},ar.clearHash=function(){window.location.hash=""},ar.isInIframe=function(){return window.parent!==window},ar.getDefaultRedirectUri=function(){return window.location.href.split("?")[0].split("#")[0]},ar.getBrowserNetworkClient=function(){return window.fetch?new Kt:new ir},ar);function ar(){}var ur={clientId:"",authority:null,redirectUri:function(){return sr.getDefaultRedirectUri()},postLogoutRedirectUri:function(){return sr.getDefaultRedirectUri()},navigateToLoginRequestUrl:!0},hr={cacheLocation:Dt,storeAuthStateInCookie:!1},pr={loggerOptions:{loggerCallback:function(e,t,r){if(!r)switch(e){case G.Error:return void console.error(t);case G.Info:return void console.info(t);case G.Verbose:return void console.debug(t);case G.Warning:return void console.warn(t)}},piiLoggingEnabled:!1},networkClient:sr.getBrowserNetworkClient(),windowHashTimeout:6e4};var dr,lr={code:"storage_not_supported",desc:"Given storage configuration option was not supported."},fr={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},gr={code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},yr=(t(mr,dr=d),mr.createStorageNotSupportedError=function(e){return new mr(lr.code,lr.desc+" Given Location: "+e)},mr.createInvalidCallbackObjectError=function(e){return new mr(gr.code,gr.desc+" Given value for callback function: "+e)},mr.createRedirectCallbacksNotSetError=function(){return new mr(fr.code,fr.desc)},mr);function mr(e,t){var r=dr.call(this,e,t)||this;return r.name="BrowserConfigurationAuthError",Object.setPrototypeOf(r,mr.prototype),r}var wr=(Er.prototype.validateWindowStorage=function(e){if("undefined"==typeof window||!window)throw or.createNoWindowObjectError();if(e!==xt&&e!==Dt)throw yr.createStorageNotSupportedError(e);if(!window[e])throw yr.createStorageNotSupportedError(e)},Er.prototype.migrateCacheEntries=function(){var r=this,e=ce+"."+re.ID_TOKEN,t=ce+"."+re.CLIENT_INFO,o=ce+"."+re.ERROR,n=ce+"."+re.ERROR_DESC,i=[this.getItem(e),this.getItem(t),this.getItem(o),this.getItem(n)];[re.ID_TOKEN,re.CLIENT_INFO,re.ERROR,re.ERROR_DESC].forEach(function(e,t){return r.migrateCacheEntry(e,i[t])})},Er.prototype.migrateCacheEntry=function(e,t){t&&this.setItem(e,t)},Er.prototype.generateCacheKey=function(t){try{return this.validateObjectKey(t),t}catch(e){return t.startsWith(""+ce)||t.startsWith(re.ADAL_ID_TOKEN)?t:ce+"."+this.clientId+"."+t}},Er.prototype.validateObjectKey=function(e){JSON.parse(e)},Er.prototype.setItem=function(e,t){var r=this.generateCacheKey(e);this.windowStorage.setItem(r,t),this.cacheConfig.storeAuthStateInCookie&&this.setItemCookie(r,t)},Er.prototype.getItem=function(e){var t=this.generateCacheKey(e),r=this.getItemCookie(t);return this.cacheConfig.storeAuthStateInCookie&&r?r:this.windowStorage.getItem(t)},Er.prototype.removeItem=function(e){var t=this.generateCacheKey(e);this.windowStorage.removeItem(t),this.cacheConfig.storeAuthStateInCookie&&this.clearItemCookie(t)},Er.prototype.containsKey=function(e){var t=this.generateCacheKey(e);return this.windowStorage.hasOwnProperty(t)||this.windowStorage.hasOwnProperty(e)},Er.prototype.getKeys=function(){return Object.keys(this.windowStorage)},Er.prototype.clear=function(){var e;for(e in this.windowStorage)this.windowStorage.hasOwnProperty(e)&&-1!==e.indexOf(ce)&&-1!==e.indexOf(this.clientId)&&this.removeItem(e)},Er.prototype.setItemCookie=function(e,t,r){var o=e+"="+t+";path=/;";r&&(o+="expires="+this.getCookieExpirationTime(r)+";"),document.cookie=o},Er.prototype.getItemCookie=function(e){for(var t=e+"=",r=document.cookie.split(";"),o=0;o<r.length;o++){for(var n=r[o];" "===n.charAt(0);)n=n.substring(1);if(0===n.indexOf(t))return n.substring(t.length,n.length)}return""},Er.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},Er.prototype.clearMsalCookie=function(e){var t=e?ee.NONCE_IDTOKEN+"|"+e:ee.NONCE_IDTOKEN;this.clearItemCookie(this.generateCacheKey(t)),this.clearItemCookie(this.generateCacheKey(ee.REQUEST_STATE)),this.clearItemCookie(this.generateCacheKey(ee.ORIGIN_URI))},Er.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+864e5*e).toUTCString()},Er);function Er(e,t){this.validateWindowStorage(t.cacheLocation),this.cacheConfig=t,this.windowStorage=window[this.cacheConfig.cacheLocation],this.clientId=e,this.migrateCacheEntries()}var vr=(Ir.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},Ir);function Ir(){}var Sr=(Cr.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,vr.decimalToHex(e[0])+vr.decimalToHex(e[1])+vr.decimalToHex(e[2])+vr.decimalToHex(e[3])+"-"+vr.decimalToHex(e[4])+vr.decimalToHex(e[5])+"-"+vr.decimalToHex(e[6])+vr.decimalToHex(e[7])+"-"+vr.decimalToHex(e[8])+vr.decimalToHex(e[9])+"-"+vr.decimalToHex(e[10])+vr.decimalToHex(e[11])+vr.decimalToHex(e[12])+vr.decimalToHex(e[13])+vr.decimalToHex(e[14])+vr.decimalToHex(e[15])}catch(e){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",o=0,n="",i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(o=16*Math.random()|0),"x"===t[i]?n+=r[o]:"y"===t[i]?(o&=3,n+=r[o|=8]):n+=t[i];return n}},Cr.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},Cr);function Cr(e){this.cryptoObj=e}var br=(Tr.stringToUtf8Arr=function(e){for(var t,r=0,o=e.length,n=0;n<o;n++)r+=(t=e.charCodeAt(n))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(r),c=0,s=0;c<r;s++)(t=e.charCodeAt(s))<128?i[c++]=t:(t<2048?i[c++]=192+(t>>>6):(t<65536?i[c++]=224+(t>>>12):(t<2097152?i[c++]=240+(t>>>18):(t<67108864?i[c++]=248+(t>>>24):(i[c++]=252+(t>>>30),i[c++]=128+(t>>>24&63)),i[c++]=128+(t>>>18&63)),i[c++]=128+(t>>>12&63)),i[c++]=128+(t>>>6&63)),i[c++]=128+(63&t));return i},Tr.utf8ArrToString=function(e){for(var t="",r=void 0,o=e.length,n=0;n<o;n++)r=e[n],t+=String.fromCharCode(251<r&&r<254&&n+5<o?1073741824*(r-252)+(e[++n]-128<<24)+(e[++n]-128<<18)+(e[++n]-128<<12)+(e[++n]-128<<6)+e[++n]-128:247<r&&r<252&&n+4<o?(r-248<<24)+(e[++n]-128<<18)+(e[++n]-128<<12)+(e[++n]-128<<6)+e[++n]-128:239<r&&r<248&&n+3<o?(r-240<<18)+(e[++n]-128<<12)+(e[++n]-128<<6)+e[++n]-128:223<r&&r<240&&n+2<o?(r-224<<12)+(e[++n]-128<<6)+e[++n]-128:191<r&&r<224&&n+1<o?(r-192<<6)+e[++n]-128:r);return t},Tr);function Tr(){}var Rr=(_r.prototype.urlEncode=function(e){return this.encode(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},_r.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},_r.prototype.encode=function(e){var t=br.stringToUtf8Arr(encodeURIComponent(e));return this.base64EncArr(t)},_r.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r="",o=void 0,n=e.length,i=0,c=0;c<n;c++)o=c%3,i|=e[c]<<(16>>>o&24),2!==o&&e.length-c!=1||(r+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0==t?r:r.substring(0,r.length-t)+(1==t?"=":"==")},_r.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},_r);function _r(){}var Or=(kr.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return decodeURIComponent(br.utf8ArrToString(r))},kr.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,""),o=r.length,n=t?Math.ceil((3*o+1>>>2)/t)*t:3*o+1>>>2,i=new Uint8Array(n),c=void 0,s=void 0,a=0,u=0,h=0;h<o;h++)if(s=3&h,a|=this.b64ToUint6(r.charCodeAt(h))<<18-6*s,3===s||o-h==1){for(c=0;c<3&&u<n;c++,u++)i[u]=a>>>(16>>>c&24)&255;a=0}return i},kr.prototype.b64ToUint6=function(e){return 64<e&&e<91?e-65:96<e&&e<123?e-71:47<e&&e<58?e+4:43===e?62:47===e?63:0},kr);function kr(){}var Ar="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",Nr=(Pr.prototype.generateCodes=function(){return s(this,void 0,void 0,function(){var t,r;return a(this,function(e){switch(e.label){case 0:return t=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(t)];case 1:return r=e.sent(),[2,{verifier:t,challenge:r}]}})})},Pr.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);this.cryptoObj.getRandomValues(e);var t=this.bufferToCVString(e);return this.base64Encode.urlEncode(t)}catch(e){throw or.createPkceNotGeneratedError(e)}},Pr.prototype.generateCodeChallengeFromVerifier=function(o){return s(this,void 0,void 0,function(){var t,r;return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(o)];case 1:return t=e.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=e.sent(),or.createPkceNotGeneratedError(r);case 3:return[2]}})})},Pr.prototype.bufferToCVString=function(e){for(var t=[],r=0;r<e.byteLength;r+=1){var o=e[r]%Ar.length;t.push(Ar[o])}return t.join("")},Pr);function Pr(e){this.base64Encode=new Rr,this.cryptoObj=e}var Ur="SHA-256",qr=(xr.prototype.sha256Digest=function(r){return s(this,void 0,void 0,function(){var t;return a(this,function(e){return t=br.stringToUtf8Arr(r),[2,this.hasIECrypto()?this.getMSCryptoDigest(Ur,t):this.getSubtleCryptoDigest(Ur,t)]})})},xr.prototype.getRandomValues=function(e){var t=window.msCrypto||window.crypto;if(!t.getRandomValues)throw or.createCryptoNotAvailableError("getRandomValues does not exist.");t.getRandomValues(e)},xr.prototype.hasIECrypto=function(){return!!window.msCrypto},xr.prototype.hasBrowserCrypto=function(){return!!window.crypto},xr.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},xr.prototype.getSubtleCryptoDigest=function(t,r){return s(this,void 0,void 0,function(){return a(this,function(e){return[2,window.crypto.subtle.digest(t,r)]})})},xr.prototype.getMSCryptoDigest=function(o,n){return s(this,void 0,void 0,function(){return a(this,function(e){return[2,new Promise(function(t,r){var e=window.msCrypto.subtle.digest(o,n.buffer);e.addEventListener("complete",function(e){t(e.target.result)}),e.addEventListener("error",function(e){r(e)})})]})})},xr);function xr(){if(!this.hasCryptoAPI())throw or.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.")}var Dr=(Lr.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},Lr.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},Lr.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},Lr.prototype.generatePkceCodes=function(){return s(this,void 0,void 0,function(){return a(this,function(e){return[2,this.pkceGenerator.generateCodes()]})})},Lr);function Lr(){this.browserCrypto=new qr,this.b64Encode=new Rr,this.b64Decode=new Or,this.guidGenerator=new Sr(this.browserCrypto),this.pkceGenerator=new Nr(this.browserCrypto)}function Mr(e,t){this.authModule=e,this.browserStorage=t}var Hr,jr=(t(Gr,Hr=Mr),Gr.prototype.showUI=function(e){if(F.isEmpty(e))throw this.authModule.logger.info("Navigate url is empty"),or.createEmptyNavigationUriError();this.browserStorage.setItem(ee.ORIGIN_URI,window.location.href),this.browserStorage.setItem(Lt,Mt),this.authModule.logger.infoPii("Navigate to:"+e);var t=sr.isInIframe();if(t)throw or.createRedirectInIframeError(t);return sr.navigateWindow(e),window},Gr.prototype.handleCodeResponse=function(r){return s(this,void 0,void 0,function(){var t;return a(this,function(e){if(F.isEmpty(r))throw or.createEmptyHashError(r);return this.browserStorage.removeItem(Lt),t=this.authModule.handleFragmentResponse(r),this.browserStorage.removeItem(ee.URL_HASH),[2,this.authModule.acquireToken(t)]})})},Gr);function Gr(){return null!==Hr&&Hr.apply(this,arguments)||this}var Kr,Fr=(t(Wr,Kr=Mr),Wr.prototype.showUI=function(e){if(F.isEmpty(e))throw this.authModule.logger.error("Navigate url is empty"),or.createEmptyNavigationUriError();return this.browserStorage.setItem(Lt,Mt),this.authModule.logger.infoPii("Navigate to:"+e),this.openPopup(e,ie,Ht,jt)},Wr.prototype.handleCodeResponse=function(r){return s(this,void 0,void 0,function(){var t;return a(this,function(e){if(F.isEmpty(r))throw or.createEmptyHashError(r);return t=this.authModule.handleFragmentResponse(r),[2,this.authModule.acquireToken(t)]})})},Wr.prototype.monitorWindowForHash=function(s,e,a){var u=this;return new Promise(function(r,o){var n=e/Gt,i=0,c=setInterval(function(){if(s.closed)return u.cleanPopup(),clearInterval(c),void o(or.createUserCancelledError());var e;try{e=s.location.href}catch(e){}if(e&&"about:blank"!==e){if(i++,dt.hashContainsKnownProperties(e)){var t=s.location.hash;return u.cleanPopup(s),clearInterval(c),void r(t)}return n<i?(u.cleanPopup(s),clearInterval(c),void o(or.createPopupWindowTimeoutError(a))):void 0}},Gt)})},Wr.prototype.openPopup=function(e,t,r,o){try{var n=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,c=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,a=c/2-r/2+n,u=s/2-o/2+i,h=window.open(e,t,"width="+r+", height="+o+", top="+u+", left="+a);if(!h)throw or.createEmptyWindowCreatedError();return h.focus&&h.focus(),this.currentWindow=h,window.addEventListener("beforeunload",this.unloadWindow),h}catch(e){throw this.authModule.logger.error("error opening popup "+e.message),this.browserStorage.removeItem(Lt),or.createPopupWindowError(e.toString())}},Wr.prototype.unloadWindow=function(e){this.authModule.cancelRequest(),this.browserStorage.removeItem(Lt),this.currentWindow.close(),delete e.returnValue},Wr.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.removeItem(Lt)},Wr);function Wr(e,t){var r=Kr.call(this,e,t)||this;return r.unloadWindow=r.unloadWindow.bind(r),r}var zr=(Jr.prototype.handleRedirectCallback=function(r){return s(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:if(!r)throw yr.createInvalidCallbackObjectError(r);this.authCallback=r,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.handleRedirectResponse()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),this.authCallback(t),[3,4];case 4:return[2]}})})},Jr.prototype.handleRedirectResponse=function(){return s(this,void 0,void 0,function(){var t,r,o,n;return a(this,function(e){return t=window.location.hash,r=this.browserStorage.getItem(ee.URL_HASH),o=dt.hashContainsKnownProperties(t),this.config.auth.navigateToLoginRequestUrl&&o&&!sr.isInIframe()?(this.browserStorage.setItem(ee.URL_HASH,t),n=this.browserStorage.getItem(ee.ORIGIN_URI),F.isEmpty(n)||"null"===n?(this.authModule.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),sr.navigateWindow("/",!0)):sr.navigateWindow(n,!0),[2]):o?this.config.auth.navigateToLoginRequestUrl?[2]:(sr.clearHash(),[2,this.handleHash(t)]):[2,this.handleHash(r)]})})},Jr.prototype.handleHash=function(o){return s(this,void 0,void 0,function(){var t,r;return a(this,function(e){switch(e.label){case 0:return t=new jr(this.authModule,this.browserStorage),F.isEmpty(o)?[3,2]:[4,t.handleCodeResponse(o)];case 1:return r=e.sent(),this.authCallback(null,r),[3,3];case 2:this.cleanRequest(),e.label=3;case 3:return[2]}})})},Jr.prototype.loginRedirect=function(e){if(!this.authCallback)throw yr.createRedirectCallbacksNotSetError();if(this.interactionInProgress())this.authCallback(or.createInteractionInProgressError());else try{var t=new jr(this.authModule,this.browserStorage);this.authModule.createLoginUrl(e).then(function(e){t.showUI(e)})}catch(e){throw this.cleanRequest(),e}},Jr.prototype.acquireTokenRedirect=function(e){if(!this.authCallback)throw yr.createRedirectCallbacksNotSetError();if(this.interactionInProgress())this.authCallback(or.createInteractionInProgressError());else try{var t=new jr(this.authModule,this.browserStorage);this.authModule.createAcquireTokenUrl(e).then(function(e){t.showUI(e)})}catch(e){throw this.cleanRequest(),e}},Jr.prototype.loginPopup=function(r){return s(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:if(this.interactionInProgress())throw or.createInteractionInProgressError();return[4,this.authModule.createLoginUrl(r)];case 1:return t=e.sent(),[2,this.popupTokenHelper(t)]}})})},Jr.prototype.acquireTokenPopup=function(r){return s(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:if(this.interactionInProgress())throw or.createInteractionInProgressError();return[4,this.authModule.createAcquireTokenUrl(r)];case 1:return t=e.sent(),[2,this.popupTokenHelper(t)]}})})},Jr.prototype.popupTokenHelper=function(i){return s(this,void 0,void 0,function(){var t,r,o,n;return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),t=new Fr(this.authModule,this.browserStorage),r=t.showUI(i),[4,t.monitorWindowForHash(r,this.config.system.windowHashTimeout,i)];case 1:return o=e.sent(),[4,t.handleCodeResponse(o)];case 2:return[2,e.sent()];case 3:throw n=e.sent(),this.cleanRequest(),n;case 4:return[2]}})})},Jr.prototype.acquireTokenSilent=function(t){return s(this,void 0,void 0,function(){return a(this,function(e){return[2,this.authModule.renewToken(t)]})})},Jr.prototype.logout=function(){this.authModule.logout().then(function(e){sr.navigateWindow(e)})},Jr.prototype.getRedirectUri=function(){return this.authModule.getRedirectUri()},Jr.prototype.getPostLogoutRedirectUri=function(){return this.authModule.getPostLogoutRedirectUri()},Jr.prototype.getAccount=function(){return this.authModule.getAccount()},Jr.prototype.interactionInProgress=function(){return this.browserStorage.getItem(Lt)===Mt},Jr.prototype.cleanRequest=function(){this.browserStorage.removeItem(Lt),this.authModule.cancelRequest()},Jr);function Jr(e){this.authCallback=null,this.config=function(e){var t=e.auth,r=e.cache,o=void 0===r?{}:r,n=e.system,i=void 0===n?{}:n;return{auth:c(c({},ur),t),cache:c(c({},hr),o),system:c(c({},pr),i)}}(e),this.browserCrypto=new Dr,this.networkClient=this.config.system.networkClient,this.browserStorage=new wr(this.config.auth.clientId,this.config.cache),this.authModule=new Nt({auth:this.config.auth,systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,telemetry:this.config.system.telemetry},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage})}e.AuthError=d,e.AuthErrorMessage=h,e.PublicClientApplication=zr,Object.defineProperty(e,"__esModule",{value:!0})});
